---
// Comment.astro
---

<div id="tcomment" class="mt-8" />

<script is:inline>
  function loadTwikoo() {
    if (window.twikoo || document.getElementById('twikoo-js')) return;

    const script = document.createElement('script');
    script.id = 'twikoo-js';
    script.src = 'https://cdn.staticfile.org/twikoo/1.6.32/twikoo.all.min.js';
    script.onload = () => {
      window.twikoo.init({
        envId: 'https://comment.antiss.me/.netlify/functions/twikoo',
        el: '#tcomment',
        lang: 'zh-CN',
        theme: 'auto'
      });
    };
    document.body.appendChild(script);
  }

  if (document.readyState !== 'loading') {
    loadTwikoo();
  } else {
    document.addEventListener('DOMContentLoaded', loadTwikoo);
  }

  // Astro 页内路由支持
  document.addEventListener('astro:page-load', loadTwikoo);
</script>
